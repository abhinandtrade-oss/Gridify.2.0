<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Search | House of Pachu Admin</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/icon/flaticon_glamer.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Admin CSS -->
    <link rel="stylesheet" href="css/admin.css">
    <style>
        .search-container {
            max-width: 800px;
            margin: 2rem auto;
        }

        .search-box {
            position: relative;
            margin-bottom: 2rem;
        }

        .search-box i {
            position: absolute;
            left: 1.25rem;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .search-input {
            padding: 1.25rem 1.25rem 1.25rem 3.5rem;
            font-size: 1.25rem;
            border-radius: 1rem;
            border: 2px solid #e9ecef;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #0d6efd;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            outline: none;
        }

        .result-section {
            margin-bottom: 2.5rem;
            display: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #f8f9fa;
        }

        .section-header h2 {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0;
            color: #212529;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid #e9ecef;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-color: #dee2e6;
        }

        .badge-type {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .type-order {
            background: #e7f1ff;
            color: #0d6efd;
        }

        .type-product {
            background: #fef1f2;
            color: #e11d48;
        }

        .type-return {
            background: #f0fdf4;
            color: #16a34a;
        }

        .type-ticket {
            background: #faf5ff;
            color: #7c3aed;
        }

        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: #6c757d;
        }

        .no-results i {
            display: block;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Loading state */
        .searching-loader {
            display: none;
            text-align: center;
            padding: 2rem;
        }
    </style>

    <!-- Lucide Icons -->
    <script src="https://cdn.jsdelivr.net/npm/lucide/dist/umd/lucide.min.js"></script>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/supabase-config.js"></script>
    <script src="js/auth-check.js"></script>
</head>

<body>

    <button class="sidebar-toggle">
        <i data-lucide="menu"></i>
    </button>

    <div class="sidebar-overlay"></div>

    <main class="admin-main">
        <header class="page-header">
            <div class="page-title">
                <h1>Global Search</h1>
                <p>Search across orders, products, returns, and support tickets.</p>
            </div>
        </header>

        <div class="search-container">
            <div class="search-box">
                <i data-lucide="search" size="24"></i>
                <input type="text" id="global-search-input" class="form-control search-input"
                    placeholder="Search SKU, Order ID, Return ID, or Ticket #..." autofocus>
            </div>

            <div id="searching-loader" class="searching-loader">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Searching...</span>
                </div>
                <p class="mt-2 text-muted">Searching through database...</p>
            </div>

            <div id="search-results">
                <!-- Results Section: Orders -->
                <section id="results-orders" class="result-section">
                    <div class="section-header">
                        <i data-lucide="shopping-cart" class="text-primary"></i>
                        <h2>Orders</h2>
                        <span class="badge rounded-pill bg-primary ms-auto" id="count-orders">0</span>
                    </div>
                    <div class="results-grid" id="grid-orders"></div>
                </section>

                <!-- Results Section: Products (SKU) -->
                <section id="results-products" class="result-section">
                    <div class="section-header">
                        <i data-lucide="package" class="text-danger"></i>
                        <h2>Products (SKUs)</h2>
                        <span class="badge rounded-pill bg-danger ms-auto" id="count-products">0</span>
                    </div>
                    <div class="results-grid" id="grid-products"></div>
                </section>

                <!-- Results Section: Returns -->
                <section id="results-returns" class="result-section">
                    <div class="section-header">
                        <i data-lucide="refresh-cw" class="text-success"></i>
                        <h2>Returns</h2>
                        <span class="badge rounded-pill bg-success ms-auto" id="count-returns">0</span>
                    </div>
                    <div class="results-grid" id="grid-returns"></div>
                </section>

                <!-- Results Section: Tickets -->
                <section id="results-tickets" class="result-section">
                    <div class="section-header">
                        <i data-lucide="ticket" class="text-purple" style="color: #7c3aed;"></i>
                        <h2>Support Tickets</h2>
                        <span class="badge rounded-pill ms-auto" id="count-tickets"
                            style="background-color: #7c3aed;">0</span>
                    </div>
                    <div class="results-grid" id="grid-tickets"></div>
                </section>

                <div id="no-results-msg" class="no-results" style="display: none;">
                    <i data-lucide="search-x" size="48"></i>
                    <h3>No matching records found</h3>
                    <p>Try searching for a different ID or SKU</p>
                </div>

                <div id="initial-msg" class="no-results">
                    <i data-lucide="keyboard" size="48"></i>
                    <h3>Start typing to search</h3>
                    <p>Enter at least 3 characters to begin searching</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Order Detail Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title fw-bold">Order Details <span id="modal-order-id"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body p-4" id="modal-order-body">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/global-search.js"></script>
    <script>
        // Initialize Lucide Icons
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }
    </script>
</body>

</html>